From a0473b29add9521ffd4c74f6f623b418811762b0 Mon Sep 17 00:00:00 2001
From: Cristy <mikayla-grace@urban-warrior.org>
Date: Sat, 9 Feb 2019 21:21:19 -0500
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/1472

---
 coders/cin.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/coders/cin.c b/coders/cin.c
index 91c53c69d..ac0c23039 100644
--- a/coders/cin.c
+++ b/coders/cin.c
@@ -724,6 +724,8 @@ static Image *ReadCINImage(const ImageInfo *image_info,ExceptionInfo *exception)
       (void) CloseBlob(image);
       return(image);
     }
+  if (((MagickSizeType) image->columns*image->rows) > GetBlobSize(image))
+    ThrowReaderException(CorruptImageError,"InsufficientImageDataInFile");
   for ( ; offset < (MagickOffsetType) cin.file.image_offset; offset++)
   {
     int
