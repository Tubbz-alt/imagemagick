Backport of:

From 0b7d3675438cbcde824e751895847a0794406e08 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Sat, 15 Jun 2019 22:04:30 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/1589

---
 magick/annotate.c | 15 +++++++++++----
 1 file changed, 11 insertions(+), 4 deletions(-)

--- a/magick/annotate.c
+++ b/magick/annotate.c
@@ -323,7 +323,12 @@ MagickExport MagickBooleanType AnnotateI
       (void) ParseGeometry(annotate_info->geometry,&geometry_info);
     }
   if (SetImageStorageClass(image,DirectClass) == MagickFalse)
-    return(MagickFalse);
+    {
+      annotate_info=DestroyDrawInfo(annotate_info);
+      annotate=DestroyDrawInfo(annotate);
+      textlist=(char **) RelinquishMagickMemory(textlist);
+      return(MagickFalse);
+    }
   if (IsGrayColorspace(image->colorspace) != MagickFalse)
     (void) SetImageColorspace(image,sRGBColorspace);
   status=MagickTrue;
