From: Cristy <mikayla-grace@urban-warrior.org>
Date: Sun, 24 Mar 2019 15:05:45 -0400
Subject: https://github.com/ImageMagick/ImageMagick/issues/1522
Origin: https://github.com/ImageMagick/ImageMagick6/commit/27b1c74979ac473a430e266ff6c4b645664bc805
Bug-Debian-Security: https://security-tracker.debian.org/tracker/CVE-2019-12979
Bug-Debian: https://bugs.debian.org/931189
Bug: https://github.com/ImageMagick/ImageMagick/issues/1522

---
  magick/image.c | 9 +++++----
  1 file changed, 5 insertions(+), 4 deletions(-)

diff --git a/magick/image.c b/magick/image.c
index 7eec107..f81e1c8 100644
--- a/magick/image.c
+++ b/magick/image.c
@@ -252,10 +252,11 @@ MagickExport Image *AcquireImage(const ImageInfo *image_info)
         geometry_info;
 
       flags=ParseGeometry(image_info->density,&geometry_info);
-      image->x_resolution=geometry_info.rho;
-      image->y_resolution=geometry_info.sigma;
-      if ((flags & SigmaValue) == 0)
-        image->y_resolution=image->x_resolution;
+      if ((flags & RhoValue) != 0)
+        image->x_resolution=geometry_info.rho;
+      image->y_resolution=image->x_resolution;
+      if ((flags & SigmaValue) != 0)
+        image->y_resolution=geometry_info.sigma;
     }
   if (image_info->page != (char *) NULL)
     {
