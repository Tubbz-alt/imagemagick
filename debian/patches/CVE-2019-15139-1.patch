Backport of:

From 6d46f0a046a58e7c4567a86ba1b9cb847d5b1968 Mon Sep 17 00:00:00 2001
From: Cristy <mikayla-grace@urban-warrior.org>
Date: Sat, 20 Apr 2019 09:39:53 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/1553

---
 coders/xwd.c | 3 +++
 1 file changed, 3 insertions(+)

--- a/coders/xwd.c
+++ b/coders/xwd.c
@@ -252,6 +252,8 @@ static Image *ReadXWDImage(const ImageIn
     ThrowReaderException(CorruptImageError,"ImproperImageHeader");
   if (header.ncolors > 256)
     ThrowReaderException(CorruptImageError,"ImproperImageHeader");
+  if ((MagickSizeType) header.xoffset >= GetBlobSize(image))
+    ThrowReaderException(CorruptImageError,"ImproperImageHeader");
   switch (header.visual_class) {
     case StaticGray:
     case GrayScale:
@@ -638,6 +640,7 @@ ModuleExport size_t RegisterXWDImage(voi
   entry->encoder=(EncodeImageHandler *) WriteXWDImage;
 #endif
   entry->magick=(IsImageFormatHandler *) IsXWD;
+  entry->seekable_stream=MagickTrue;
   entry->adjoin=MagickFalse;
   entry->description=ConstantString("X Windows system window dump (color)");
   entry->module=ConstantString("XWD");
